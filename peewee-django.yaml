rules:
  - id: peewee-django
    message: Untrusted input might be used to build a database query, which can lead
      to a SQL injection vulnerability. An attacker can execute malicious SQL
      statements and gain unauthorized access to sensitive data, modify, delete
      data, or execute arbitrary system commands. Peewee provides a query
      builder which should allow to create the SQL query in a safe way. If you
      cannot use it, make sure to check the value exists in an allowlist, such
      that no user-controllable value can influence the eventual SQL query.
    severity: ERROR
    metadata:
      likelihood: HIGH
      impact: HIGH
      confidence: HIGH
      category: security
      subcategory:
        - vuln
      cwe:
        - "CWE-89: Improper Neutralization of Special Elements used in an SQL
          Command ('SQL Injection')"
      cwe2020-top25: true
      cwe2021-top25: true
      cwe2022-top25: true
      display-name: SQL Injection with Peewee
      functional-categories:
        - db::sink::sql-or-nosql-query::peewee
        - web::source::cookie::django
        - web::source::cookie::django_allauth
        - web::source::cookie::django_channels
        - web::source::cookie::django_rest_frameworkapi
        - web::source::form-data::django
        - web::source::form-data::django_allauth
        - web::source::form-data::django_channels
        - web::source::form-data::django_rest_frameworkapi
        - web::source::header::django
        - web::source::header::django_allauth
        - web::source::header::django_channels
        - web::source::header::django_rest_frameworkapi
        - web::source::http-body::django
        - web::source::http-body::django_allauth
        - web::source::http-body::django_channels
        - web::source::http-body::django_rest_frameworkapi
        - web::source::http-params::django
        - web::source::http-params::django_allauth
        - web::source::http-params::django_channels
        - web::source::http-params::django_rest_frameworkapi
        - web::source::url-path-params::django
        - web::source::url-path-params::django_allauth
        - web::source::url-path-params::django_channels
        - web::source::url-path-params::django_rest_frameworkapi
      owasp:
        - A01:2017 - Injection
        - A03:2021 - Injection
      references:
        - https://owasp.org/Top10/A03_2021-Injection
      technology:
        - django
        - django.views
        - django.views.generic
        - django_allauth
        - django_channels
        - django_rest_frameworkapi
        - peewee
        - sql
        - web
      license: Copyright 2023 Semgrep, Inc.
      vulnerability_class:
        - SQL Injection
    languages:
      - python
    mode: taint
    min-version: 1.81.0
    options:
      interfile: true
      symbolic_propagation: true
      taint_assume_safe_booleans: true
      taint_assume_safe_numbers: true
    pattern-sources:
      - label: __SOURCE__
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      class $CLS(..., django.views.View, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.base.View, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.TemplateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.RedirectView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.detail.DetailView,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.list.ListView, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.edit.FormView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.CreateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.UpdateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.DeleteView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.ArchiveIndexView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.YearArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.MonthArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.WeekArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DayArchiveView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.TodayArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DateDetailView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.ContextMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.base.TemplateResponseMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.detail.SingleObjectMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.detail.SingleObjectTemplateResponseMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.list.MultipleObjectMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.list.MultipleObjectTemplateResponseMixin,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.edit.FormMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.ModelFormMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.ProcessFormView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.DeletionMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.YearMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.MonthMixin,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.dates.DayMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.WeekMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DateMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.BaseDateListView, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., haystack.forms.SearchForm, ...):
                        ...
                  - patterns:
                      - pattern-inside: |
                          class $CLS(...):
                              ...
                      - semgrep-internal-metavariable-name:
                          kind: django-view
                          metavariable: $CLS
              - pattern-either:
                  - pattern: self.get_year()
                  - pattern: super().get_year()
                  - pattern: self.year
                  - pattern: super().year
                  - pattern: self.get_month()
                  - pattern: super().get_month()
                  - pattern: self.month
                  - pattern: super().month
                  - pattern: self.get_day()
                  - pattern: super().get_day()
                  - pattern: self.day
                  - pattern: super().day
                  - pattern: self.get_week()
                  - pattern: super().get_week()
                  - pattern: self.week
                  - pattern: super().week
                  - pattern: self.cleaned_data
                  - pattern: super().cleaned_data
      - label: __SOURCE__
        patterns:
          - patterns:
              - pattern-either:
                  - pattern: $DJANGO_REQUEST.query_params
                  - pattern: $DJANGO_REQUEST.stream
                  - pattern: $DJANGO_REQUEST.content_type
                  - pattern: $DJANGO_REQUEST.data
                  - pattern: $DJANGO_REQUEST.user_agent_string
                  - pattern: $DJANGO_REQUEST.user_agent
                  - pattern: $DJANGO_REQUEST.body
                  - pattern: $DJANGO_REQUEST.headers
                  - pattern: $DJANGO_REQUEST.path
                  - pattern: $DJANGO_REQUEST.path_info
                  - patterns:
                      - pattern: $DJANGO_REQUEST.META
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_LENGTH
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_TYPE
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_ENCODING
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_LANGUAGE
                      - pattern-not: $DJANGO_REQUEST.META.REMOTE_ADDR
                      - pattern-not: $DJANGO_REQUEST.META.REQUEST_METHOD
                      - pattern-not: $DJANGO_REQUEST.META.SERVER_PORT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_X_FORWARDED_FOR
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_LENGTH")
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_TYPE")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_ENCODING")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_LANGUAGE")
                      - pattern-not: $DJANGO_REQUEST.META.get("REMOTE_ADDR")
                      - pattern-not: $DJANGO_REQUEST.META.get("REQUEST_METHOD")
                      - pattern-not: $DJANGO_REQUEST.META.get("SERVER_PORT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_X_FORWARDED_FOR")
                  - pattern: $DJANGO_REQUEST.REQUEST
                  - pattern: $DJANGO_REQUEST.GET
                  - pattern: $DJANGO_REQUEST.POST
                  - pattern: $DJANGO_REQUEST.FILES
                  - pattern: $DJANGO_REQUEST.DATA
                  - pattern: $DJANGO_REQUEST.QUERY_PARAMS
                  - pattern: $DJANGO_REQUEST.COOKIES
                  - pattern: $DJANGO_REQUEST.get_host()
                  - pattern: $DJANGO_REQUEST.get_full_path(...)
                  - pattern: $DJANGO_REQUEST.get_full_path_info(...)
                  - pattern: $DJANGO_REQUEST.get_raw_uri(...)
                  - pattern: $DJANGO_REQUEST.encoding(...)
                  - pattern: $DJANGO_REQUEST.body(...)
                  - pattern: $DJANGO_REQUEST.read(...)
                  - pattern: $DJANGO_REQUEST.readline()
                  - pattern: $DJANGO_REQUEST.readlines()
                  - pattern: $DJANGO_REQUEST.get_signed_cookie(...)
        requires: DJANGO_REQUEST
      - label: DJANGO_REQUEST
        patterns:
          - patterns:
              - pattern-either:
                  - patterns:
                      - pattern: |
                          @rest_framework.decorators.api_view(...)
                          def $FUNC($DJANGO_REQUEST, ...):
                            ...
                      - focus-metavariable: $DJANGO_REQUEST
                  - patterns:
                      - pattern: |
                          class $CLS(..., $PARENT_CLASS, ...):
                              ...
                              def $FUNC(self, $DJANGO_REQUEST, ...):
                                ...
                      - metavariable-pattern:
                          metavariable: $PARENT_CLASS
                          patterns:
                            - pattern-either:
                                - pattern: rest_framework.views.APIView
                                - pattern: rest_framework.generics.CreateAPIView
                                - pattern: rest_framework.generics.DestroyAPIView
                                - pattern: rest_framework.generics.GenericAPIView
                                - pattern: rest_framework.generics.ListAPIView
                                - pattern: rest_framework.generics.ListCreateAPIView
                                - pattern: rest_framework.generics.RetrieveAPIView
                                - pattern: rest_framework.generics.RetrieveDestroyAPIView
                                - pattern: rest_framework.generics.RetrieveUpdateAPIView
                                - pattern: rest_framework.generics.RetrieveUpdateDestroyAPIView
                                - pattern: rest_framework.generics.UpdateAPIView
                                - pattern: rest_framework.viewsets.GenericViewSet
                                - pattern: rest_framework.viewsets.ModelViewSet
                                - pattern: rest_framework.viewsets.ReadOnlyModelViewSet
                                - pattern: rest_framework.viewsets.ViewSet
                                - pattern: rest_framework.viewsets.ViewSetMixin
                      - metavariable-regex:
                          metavariable: $FUNC
                          regex: get|post|put|patch|delete|head|options|dispatch|initial|throttled|retrieve|update|partial_update|destroy|list|create
                      - focus-metavariable: $DJANGO_REQUEST
                  - patterns:
                      - pattern-either:
                          - pattern-inside: |
                              class $CLS(..., django.views.View, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(..., django.views.generic.base.View,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.base.TemplateView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.base.RedirectView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.detail.DetailView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.list.ListView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.FormView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.CreateView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.UpdateView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.DeleteView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.ArchiveIndexView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.YearArchiveView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.MonthArchiveView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.WeekArchiveView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.DayArchiveView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.TodayArchiveView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.DateDetailView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.base.ContextMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.base.TemplateResponseMixin,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.detail.SingleObjectMixin,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.detail.SingleObjectTemplateResponseMixin,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.list.MultipleObjectMixin,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.list.MultipleObjectTemplateResponseMixin,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.FormMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.ModelFormMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.ProcessFormView, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.edit.DeletionMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.YearMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.MonthMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.DayMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.WeekMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.DateMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              django.views.generic.dates.BaseDateListView, ...):
                                ...
                          - pattern-inside: |
                              class $CLS(..., haystack.forms.SearchForm, ...):
                                ...
                          - patterns:
                              - pattern-inside: |
                                  class $CLS(...):
                                      ...
                              - semgrep-internal-metavariable-name:
                                  kind: django-view
                                  metavariable: $CLS
                      - pattern-either:
                          - patterns:
                              - pattern: |
                                  def $FUNC($SELF, $DJANGO_REQUEST, ...):
                                    ...
                              - metavariable-regex:
                                  metavariable: $FUNC
                                  regex: ^(setup|dispatch|http_method_not_allowed|options|get|post|delete|head|put|patch)$
                              - focus-metavariable: $DJANGO_REQUEST
                          - pattern: self.request
                  - patterns:
                      - pattern: |
                          def $VIEW($DJANGO_REQUEST, ...):
                            ...
                      - semgrep-internal-metavariable-name:
                          kind: django-view
                          metavariable: $VIEW
                      - focus-metavariable: $DJANGO_REQUEST
                  - patterns:
                      - pattern-either:
                          - pattern-inside: >
                              class $CLS(..., rest_framework.viewsets.ViewSet,
                              ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              rest_framework.viewsets.ViewSetMixin, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              rest_framework.viewsets.GenericViewSet, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              rest_framework.viewsets.ModelViewSet, ...):
                                ...
                          - pattern-inside: >
                              class $CLS(...,
                              rest_framework.viewsets.ReadOnlyModelViewSet,
                              ...):
                                ...
                      - pattern-either:
                          - patterns:
                              - pattern: |
                                  def $FUNC($SELF, $DJANGO_REQUEST, ...):
                                    ...
                              - metavariable-regex:
                                  metavariable: $FUNC
                                  regex: ^(list|create|retrieve|update|partial_update|destroy)$
                              - focus-metavariable: $DJANGO_REQUEST
                          - patterns:
                              - pattern: |
                                  @rest_framework.decorators.action(...)
                                  def $FUNC($SELF, $DJANGO_REQUEST, ...):
                                    ...
                              - focus-metavariable: $DJANGO_REQUEST
                          - pattern: self.request
      - patterns:
          - pattern: |
              def $VIEW($DJANGO_REQUEST, ..., $PARAM, ...):
                ...
          - semgrep-internal-metavariable-name:
              kind: django-view
              metavariable: $VIEW
          - focus-metavariable: $PARAM
      - label: __SOURCE__
        patterns:
          - patterns:
              - pattern-either:
                  - pattern: $DJANGO_FORM.cleaned_data
        requires: DJANGO_FORM
      - label: DJANGO_FORM
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      class $CLS(..., django.views.View, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.base.View, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.TemplateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.RedirectView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.detail.DetailView,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.list.ListView, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.edit.FormView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.CreateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.UpdateView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.DeleteView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.ArchiveIndexView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.YearArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.MonthArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.WeekArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DayArchiveView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.TodayArchiveView, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DateDetailView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.base.ContextMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.base.TemplateResponseMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.detail.SingleObjectMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.detail.SingleObjectTemplateResponseMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.list.MultipleObjectMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.list.MultipleObjectTemplateResponseMixin,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.edit.FormMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.ModelFormMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.ProcessFormView,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.edit.DeletionMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.YearMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.MonthMixin,
                      ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., django.views.generic.dates.DayMixin, ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.WeekMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(..., django.views.generic.dates.DateMixin,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CLS(...,
                      django.views.generic.dates.BaseDateListView, ...):
                        ...
                  - pattern-inside: |
                      class $CLS(..., haystack.forms.SearchForm, ...):
                        ...
                  - patterns:
                      - pattern-inside: |
                          class $CLS(...):
                              ...
                      - semgrep-internal-metavariable-name:
                          kind: django-view
                          metavariable: $CLS
              - pattern-either:
                  - patterns:
                      - pattern: |
                          def $FUNC($SELF, $FORM, ...):
                            ...
                      - metavariable-regex:
                          metavariable: $FUNC
                          regex: ^(form_valid|form_invalid)$
                      - focus-metavariable: $FORM
                  - pattern-either:
                      - pattern: self.get_form_kwargs()
                      - pattern: super().get_form_kwargs()
                      - pattern: self.get_form()
                      - pattern: super().get_form()
      - pattern-either:
          - patterns:
              - pattern-inside: |
                  class $LOGINFORM(..., allauth.account.forms.LoginForm, ...):
                    ...
              - pattern-inside: |
                  def login(self, *$ARGS, **$KWARGS):
                    ...
              - pattern-either:
                  - pattern: $ARGS
                  - pattern: $KWARGS
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      class $FORM(..., allauth.account.forms.AddEmailForm, ...):
                        ...
                  - pattern-inside: >
                      class $FORM(..., allauth.account.forms.ChangePasswordForm,
                      ...):
                        ...
                  - pattern-inside: >
                      class $FORM(..., allauth.account.forms.SetPasswordForm,
                      ...):
                        ...
                  - pattern-inside: >
                      class $FORM(..., allauth.account.forms.ResetPasswordForm,
                      ...):
                        ...
                  - pattern-inside: >
                      class $FORM(...,
                      allauth.account.forms.ResetPasswordKeyForm, ...):
                        ...
                  - pattern-inside: >
                      class $FORM(..., allauth.socialaccount.forms.SignupForm,
                      ...):
                        ...
                  - pattern-inside: >
                      class $FORM(...,
                      allauth.socialaccount.forms.DisconectForm, ...):
                        ...
              - pattern-inside: |
                  def save(self, $DJANGO_REQUEST):
                    ...
              - pattern-either:
                  - pattern: self.request
                  - pattern: $DJANGO_REQUEST.query_params
                  - pattern: $DJANGO_REQUEST.stream
                  - pattern: $DJANGO_REQUEST.content_type
                  - pattern: $DJANGO_REQUEST.data
                  - pattern: $DJANGO_REQUEST.user_agent_string
                  - pattern: $DJANGO_REQUEST.user_agent
                  - pattern: $DJANGO_REQUEST.body
                  - pattern: $DJANGO_REQUEST.headers
                  - pattern: $DJANGO_REQUEST.path
                  - pattern: $DJANGO_REQUEST.path_info
                  - patterns:
                      - pattern: $DJANGO_REQUEST.META
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_LENGTH
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_TYPE
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_ENCODING
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_LANGUAGE
                      - pattern-not: $DJANGO_REQUEST.META.REMOTE_ADDR
                      - pattern-not: $DJANGO_REQUEST.META.REQUEST_METHOD
                      - pattern-not: $DJANGO_REQUEST.META.SERVER_PORT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_X_FORWARDED_FOR
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_LENGTH")
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_TYPE")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_ENCODING")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_LANGUAGE")
                      - pattern-not: $DJANGO_REQUEST.META.get("REMOTE_ADDR")
                      - pattern-not: $DJANGO_REQUEST.META.get("REQUEST_METHOD")
                      - pattern-not: $DJANGO_REQUEST.META.get("SERVER_PORT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_X_FORWARDED_FOR")
                  - pattern: $DJANGO_REQUEST.REQUEST
                  - pattern: $DJANGO_REQUEST.GET
                  - pattern: $DJANGO_REQUEST.POST
                  - pattern: $DJANGO_REQUEST.FILES
                  - pattern: $DJANGO_REQUEST.DATA
                  - pattern: $DJANGO_REQUEST.QUERY_PARAMS
                  - pattern: $DJANGO_REQUEST.COOKIES
                  - pattern: $DJANGO_REQUEST.get_host()
                  - pattern: $DJANGO_REQUEST.get_full_path(...)
                  - pattern: $DJANGO_REQUEST.get_full_path_info(...)
                  - pattern: $DJANGO_REQUEST.get_raw_uri(...)
                  - pattern: $DJANGO_REQUEST.encoding(...)
                  - pattern: $DJANGO_REQUEST.body(...)
                  - pattern: $DJANGO_REQUEST.read(...)
                  - pattern: $DJANGO_REQUEST.readline()
                  - pattern: $DJANGO_REQUEST.readlines()
                  - pattern: $DJANGO_REQUEST.get_signed_cookie(...)
          - patterns:
              - pattern-either:
                  - patterns:
                      - pattern-inside: >
                          class $ADAPTER (...,
                          allauth.account.adapter.DefaultAccountAdapter, ...):
                            ...
                      - pattern-inside: |
                          def $FUNC(self, $DJANGO_REQUEST, ...):
                            ...
                      - metavariable-regex:
                          metavariable: $FUNC
                          regex: ^(add_message|authenticate|confirm_email|get_email_confirmation_url|get_login_redirect_url|get_logout_redirect_url|get_password_change_redirect_url|is_email_verified|is_open_for_signup|new_user|populate_username|save_user)$
                  - patterns:
                      - pattern-inside: >
                          class $ADAPTER (...,
                          allauth.socialaccount.adapter.DefaultSocialAccountAdapter,
                          ...):
                            ...
                      - pattern-inside: |
                          def $FUNC(self, $DJANGO_REQUEST, ...):
                            ...
                      - metavariable-regex:
                          metavariable: $FUNC
                          regex: ^(get_connect_redirect_url|get_provider|is_open_for_signup|list_apps|new_user|on_authentication_error|populate_user|pre_social_login|save_user)$
              - pattern-either:
                  - pattern: $DJANGO_REQUEST.query_params
                  - pattern: $DJANGO_REQUEST.stream
                  - pattern: $DJANGO_REQUEST.content_type
                  - pattern: $DJANGO_REQUEST.data
                  - pattern: $DJANGO_REQUEST.user_agent_string
                  - pattern: $DJANGO_REQUEST.user_agent
                  - pattern: $DJANGO_REQUEST.body
                  - pattern: $DJANGO_REQUEST.headers
                  - pattern: $DJANGO_REQUEST.path
                  - pattern: $DJANGO_REQUEST.path_info
                  - patterns:
                      - pattern: $DJANGO_REQUEST.META
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_LENGTH
                      - pattern-not: $DJANGO_REQUEST.META.CONTENT_TYPE
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_ENCODING
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_ACCEPT_LANGUAGE
                      - pattern-not: $DJANGO_REQUEST.META.REMOTE_ADDR
                      - pattern-not: $DJANGO_REQUEST.META.REQUEST_METHOD
                      - pattern-not: $DJANGO_REQUEST.META.SERVER_PORT
                      - pattern-not: $DJANGO_REQUEST.META.HTTP_X_FORWARDED_FOR
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_LENGTH")
                      - pattern-not: $DJANGO_REQUEST.META.get("CONTENT_TYPE")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_ENCODING")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_ACCEPT_LANGUAGE")
                      - pattern-not: $DJANGO_REQUEST.META.get("REMOTE_ADDR")
                      - pattern-not: $DJANGO_REQUEST.META.get("REQUEST_METHOD")
                      - pattern-not: $DJANGO_REQUEST.META.get("SERVER_PORT")
                      - pattern-not: $DJANGO_REQUEST.META.get("HTTP_X_FORWARDED_FOR")
                  - pattern: $DJANGO_REQUEST.REQUEST
                  - pattern: $DJANGO_REQUEST.GET
                  - pattern: $DJANGO_REQUEST.POST
                  - pattern: $DJANGO_REQUEST.FILES
                  - pattern: $DJANGO_REQUEST.DATA
                  - pattern: $DJANGO_REQUEST.QUERY_PARAMS
                  - pattern: $DJANGO_REQUEST.COOKIES
                  - pattern: $DJANGO_REQUEST.get_host()
                  - pattern: $DJANGO_REQUEST.get_full_path(...)
                  - pattern: $DJANGO_REQUEST.get_full_path_info(...)
                  - pattern: $DJANGO_REQUEST.get_raw_uri(...)
                  - pattern: $DJANGO_REQUEST.encoding(...)
                  - pattern: $DJANGO_REQUEST.body(...)
                  - pattern: $DJANGO_REQUEST.read(...)
                  - pattern: $DJANGO_REQUEST.readline()
                  - pattern: $DJANGO_REQUEST.readlines()
                  - pattern: $DJANGO_REQUEST.get_signed_cookie(...)
      - pattern-either:
          - patterns:
              - pattern-either:
                  - pattern-inside: >
                      class $CONSUMER(...,
                      channels.generic.websocket.WebsocketConsumer, ...):
                        ...
                  - pattern-inside: >
                      class $CONSUMER(...,
                      channels.generic.websocket.AsyncWebsocketConsumer, ...):
                        ...
                  - pattern-inside: >
                      class $CONSUMER(...,
                      channels.generic.websocket.JsonWebsocketConsumer, ...):
                        ...
                  - pattern-inside: >
                      class $CONSUMER(...,
                      channels.generic.websocket.AsyncJsonWebsocketConsumer,
                      ...):
                        ...
                  - pattern-inside: >
                      class $CONSUMER(...,
                      channels.generic.http.AsyncHttpConsumer, ...):
                        ...
              - pattern-either:
                  - patterns:
                      - pattern-inside: |
                          def $FUNC(self, ...):
                            ...
                      - pattern: self.scope["$SCOPE_ATTRIBUTE"]
                      - metavariable-regex:
                          metavariable: $SCOPE_ATTRIBUTE
                          regex: ^(url_route|headers|path|raw_path|root_path|query_string)$
                  - patterns:
                      - pattern-inside: |
                          def $FUNC(self, ..., $ARG, ...):
                            ...
                      - metavariable-regex:
                          metavariable: $FUNC
                          regex: ^(receive|receive_json|handle)$
                      - pattern: $ARG
    pattern-propagators:
      - from: $DEFAULT
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      $DICT[$KEY]
                      ...
                  - pattern-inside: |
                      $DICT.get($KEY, $DEFAULT)
                      ...
                  - pattern-inside: |
                      $DICT = { ... }
                      ...
                  - pattern-inside: |
                      $DICT = dict(...)
                      ...
              - pattern-either:
                  - pattern: $DICT.get($FIELD, $DEFAULT)
                  - pattern: $DICT.setdefault($KEY, $DEFAULT)
        to: $DICT
      - from: $FROM_DICT
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      $TO_DICT[$KEY]
                      ...
                  - pattern-inside: |
                      $TO_DICT.get($KEY, $DEFAULT)
                      ...
                  - pattern-inside: |
                      $TO_DICT = { ... }
                      ...
                  - pattern-inside: |
                      $TO_DICT = dict(...)
                      ...
                  - pattern-inside: |
                      $FROM_DICT[$KEY]
                      ...
                  - pattern-inside: |
                      $FROM_DICT.get($KEY, $DEFAULT)
                      ...
                  - pattern-inside: |
                      $FROM_DICT = { ... }
                      ...
                  - pattern-inside: |
                      $FROM_DICT = dict(...)
                      ...
              - pattern-either:
                  - pattern: $TO_DICT.update($FROM_DICT)
                  - pattern: $TO_DICT | $FROM_DICT
                  - pattern: $TO_DICT |= $FROM_DICT
        to: $TO_DICT
      - from: $FROM
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      $LIST = [ ... ]
                      ...
                  - pattern-inside: |
                      $LIST = list(...)
                      ...
              - pattern-either:
                  - pattern: $LIST.append($FROM)
                  - pattern: $LIST.extend($FROM)
                  - pattern: $LIST.insert($INDEX, $FROM)
        to: $LIST
      - from: $FROM
        patterns:
          - patterns:
              - pattern-either:
                  - pattern: $FROM.$LOG($SINK, ...)
                  - pattern: $FROM.$LOG(..., msg=$SINK, ...)
                  - pattern: $APP.logger.$LOG($SINK, ...)
              - metavariable-regex:
                  metavariable: $LOG
                  regex: ^(info|warning|error|critical|log|exception|handle)$
        to: $SINK
      - from: $FROM
        patterns:
          - patterns:
              - pattern-either:
                  - pattern-inside: |
                      $SET = { $ITEM, ... }
                      ...
                  - pattern-inside: |
                      $SET = set(...)
                      ...
                  - pattern-inside: |
                      $OTHERSET = { $ITEM, ... }
                      ...
                  - pattern-inside: |
                      $OTHERSET = set(...)
                      ...
              - pattern-either:
                  - pattern: $SET.update(..., $FROM, ...)
                  - pattern: $SET.intersection_update(..., $FROM, ...)
                  - pattern: $SET.difference_update(..., $FROM, ...)
                  - pattern: $SET.symmetric_difference_update(..., $FROM, ...)
                  - pattern: $SET.add($FROM)
                  - pattern: $SET |= $FROM
                  - pattern: $SET &= $FROM
                  - pattern: $SET -= $FROM
                  - pattern: $SET ^= $FROM
        to: $SET
      - from: $FORM
        patterns:
          - pattern: $FORM.populate_obj($OBJ)
        to: $OBJ
    pattern-sinks:
      - patterns:
          - pattern-either:
              - patterns:
                  - pattern-either:
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.Database
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.Database = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.Database, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.Database, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.Database
                          ...
                      - pattern-inside: |
                          $DB: peewee.Database = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.Database):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.Database, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.Database:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.SqliteDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.SqliteDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.SqliteDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.SqliteDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.SqliteDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.SqliteDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.SqliteDatabase):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.SqliteDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.SqliteDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.PostgresqlDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.PostgresqlDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.PostgresqlDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.PostgresqlDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.PostgresqlDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.PostgresqlDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.PostgresqlDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (..., peewee.PostgresqlDatabase,
                          ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.PostgresqlDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.MySQLDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.MySQLDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.MySQLDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.MySQLDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.MySQLDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.MySQLDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.MySQLDatabase):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.MySQLDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.MySQLDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.DatabaseProxy
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.DatabaseProxy = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.DatabaseProxy, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.DatabaseProxy, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.DatabaseProxy
                          ...
                      - pattern-inside: |
                          $DB: peewee.DatabaseProxy = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.DatabaseProxy):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.DatabaseProxy, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.DatabaseProxy:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.apsw_ext.APSWDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.apsw_ext.APSWDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., playhouse.apsw_ext.APSWDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.apsw_ext.APSWDatabase,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.apsw_ext.APSWDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.apsw_ext.APSWDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, playhouse.apsw_ext.APSWDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.apsw_ext.APSWDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.apsw_ext.APSWDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.cockroachdb.CockroachDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.cockroachdb.CockroachDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.cockroachdb.CockroachDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.cockroachdb.CockroachDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.cockroachdb.CockroachDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.cockroachdb.CockroachDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.cockroachdb.CockroachDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.cockroachdb.CockroachDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.cockroachdb.CockroachDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MariaDBConnectorDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MariaDBConnectorDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MariaDBConnectorDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.mysql_ext.MariaDBConnectorDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.mysql_ext.MariaDBConnectorDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.mysql_ext.MariaDBConnectorDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MySQLConnectorDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MySQLConnectorDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.mysql_ext.MySQLConnectorDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.mysql_ext.MySQLConnectorDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledMySQLDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledMySQLDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledMySQLDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.pool.PooledMySQLDatabase,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledMySQLDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledMySQLDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledMySQLDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledMySQLDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.pool.PooledMySQLDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.pool.PooledPostgresqlDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledPostgresqlDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledPostgresqlDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledPostgresqlDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledPostgresqlDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.pool.PooledPostgresqlExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledPostgresqlExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledPostgresqlExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledPostgresqlExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledPostgresqlExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledSqliteDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledSqliteDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledSqliteDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledSqliteDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.pool.PooledSqliteDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledSqliteExtDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledSqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledSqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledSqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledSqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.postgres_ext.PostgresqlExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.postgres_ext.PostgresqlExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.postgres_ext.PostgresqlExtDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.postgres_ext.PostgresqlExtDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.postgres_ext.PostgresqlExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.postgres_ext.PostgresqlExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.psycopg3_ext.Psycopg3Database
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.psycopg3_ext.Psycopg3Database = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.psycopg3_ext.Psycopg3Database, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.psycopg3_ext.Psycopg3Database, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.psycopg3_ext.Psycopg3Database
                          ...
                      - pattern-inside: |
                          $DB: playhouse.psycopg3_ext.Psycopg3Database = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.psycopg3_ext.Psycopg3Database):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.psycopg3_ext.Psycopg3Database, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.psycopg3_ext.Psycopg3Database:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlcipher_ext.SqlCipherDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlcipher_ext.SqlCipherDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.CSqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.CSqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlite_ext.CSqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlite_ext.CSqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.SqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.SqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.sqlite_ext.SqliteExtDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlite_ext.SqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.SqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.SqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlite_ext.SqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlite_ext.SqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlite_ext.SqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqliteq.SqliteQueueDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqliteq.SqliteQueueDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.sqliteq.SqliteQueueDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqliteq.SqliteQueueDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqliteq.SqliteQueueDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqliteq.SqliteQueueDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqliteq.SqliteQueueDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqliteq.SqliteQueueDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.sqliteq.SqliteQueueDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.flask_utils.FlaskDB
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.flask_utils.FlaskDB = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., playhouse.flask_utils.FlaskDB, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.flask_utils.FlaskDB,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.flask_utils.FlaskDB
                          ...
                      - pattern-inside: |
                          $DB: playhouse.flask_utils.FlaskDB = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, playhouse.flask_utils.FlaskDB):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.flask_utils.FlaskDB, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.flask_utils.FlaskDB:
                            ...
                      - pattern-inside: |
                          $DB = peewee.Database(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.SqliteDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.PostgresqlDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.MySQLDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.DatabaseProxy(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.apsw_ext.APSWDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.cockroachdb.CockroachDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.mysql_ext.MariaDBConnectorDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.mysql_ext.MySQLConnectorDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledMySQLDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledPostgresqlDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledPostgresqlExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledSqliteDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledSqliteExtDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.postgres_ext.PostgresqlExtDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.psycopg3_ext.Psycopg3Database(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlcipher_ext.SqlCipherDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlite_ext.CSqliteExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlite_ext.SqliteExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqliteq.SqliteQueueDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.connect(...)
                          ...
                  - pattern-either:
                      - patterns:
                          - pattern-either:
                              - pattern: $DB.execute_sql($SINK, ...)
                              - pattern: $DB.execute_sql(..., sql=$SINK, ...)
                              - pattern: $DB.cursor().execute($SINK, ...)
                              - pattern: $DB.cursor().execute(..., query=$SINK, ...)
                              - pattern: $DB.cursor().executemany($SINK, ...)
                              - pattern: $DB.cursor().executemany(..., query=$SINK, ...)
              - patterns:
                  - pattern-either:
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $FLASK_DB: playhouse.flask_utils.FlaskDB
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $FLASK_DB: playhouse.flask_utils.FlaskDB = ...
                            ...
                      - pattern-inside: >
                          class $FLASK_DB(..., playhouse.flask_utils.FlaskDB,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $FLASK_DB:
                          playhouse.flask_utils.FlaskDB, ...):
                            ...
                      - pattern-inside: |
                          $FLASK_DB: playhouse.flask_utils.FlaskDB
                          ...
                      - pattern-inside: |
                          $FLASK_DB: playhouse.flask_utils.FlaskDB = ...
                          ...
                      - pattern-inside: >
                          if isinstance($FLASK_DB,
                          playhouse.flask_utils.FlaskDB):
                            ...
                      - pattern-inside: >
                          if isinstance($FLASK_DB, (...,
                          playhouse.flask_utils.FlaskDB, ...)):
                            ...
                      - pattern-inside: |
                          if type($FLASK_DB) == playhouse.flask_utils.FlaskDB:
                            ...
                      - pattern-inside: |
                          $FLASK_DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                      - pattern-inside: |
                          $FLASK_DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                  - pattern-either:
                      - patterns:
                          - pattern-either:
                              - pattern: $FLASK_DB.database.execute_sql($SINK, ...)
                              - pattern: $FLASK_DB.database.execute_sql(..., sql=$SINK, ...)
                              - pattern: $FLASK_DB.database.cursor().execute($SINK, ...)
                              - pattern: $FLASK_DB.database.cursor().execute(..., query=$SINK, ...)
                              - pattern: $DFLASK_DB.database.cursor().executemany($SINK, ...)
                              - pattern: $DFLASK_DB.database.cursor().executemany(..., query=$SINK, ...)
              - patterns:
                  - pattern-either:
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.Database
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.Database = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.Database, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.Database, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.Database
                          ...
                      - pattern-inside: |
                          $DB: peewee.Database = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.Database):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.Database, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.Database:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.SqliteDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.SqliteDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.SqliteDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.SqliteDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.SqliteDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.SqliteDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.SqliteDatabase):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.SqliteDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.SqliteDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.PostgresqlDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.PostgresqlDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.PostgresqlDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.PostgresqlDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.PostgresqlDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.PostgresqlDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.PostgresqlDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (..., peewee.PostgresqlDatabase,
                          ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.PostgresqlDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.MySQLDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.MySQLDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.MySQLDatabase, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.MySQLDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.MySQLDatabase
                          ...
                      - pattern-inside: |
                          $DB: peewee.MySQLDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.MySQLDatabase):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.MySQLDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.MySQLDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.DatabaseProxy
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: peewee.DatabaseProxy = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., peewee.DatabaseProxy, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $DB: peewee.DatabaseProxy, ...):
                            ...
                      - pattern-inside: |
                          $DB: peewee.DatabaseProxy
                          ...
                      - pattern-inside: |
                          $DB: peewee.DatabaseProxy = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, peewee.DatabaseProxy):
                            ...
                      - pattern-inside: |
                          if isinstance($DB, (..., peewee.DatabaseProxy, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == peewee.DatabaseProxy:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.apsw_ext.APSWDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.apsw_ext.APSWDatabase = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., playhouse.apsw_ext.APSWDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.apsw_ext.APSWDatabase,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.apsw_ext.APSWDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.apsw_ext.APSWDatabase = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, playhouse.apsw_ext.APSWDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.apsw_ext.APSWDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.apsw_ext.APSWDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.cockroachdb.CockroachDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.cockroachdb.CockroachDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.cockroachdb.CockroachDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.cockroachdb.CockroachDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.cockroachdb.CockroachDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.cockroachdb.CockroachDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.cockroachdb.CockroachDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.cockroachdb.CockroachDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.cockroachdb.CockroachDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MariaDBConnectorDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MariaDBConnectorDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MariaDBConnectorDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.mysql_ext.MariaDBConnectorDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.mysql_ext.MariaDBConnectorDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.mysql_ext.MariaDBConnectorDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.mysql_ext.MariaDBConnectorDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MySQLConnectorDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MySQLConnectorDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.mysql_ext.MySQLConnectorDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.mysql_ext.MySQLConnectorDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.mysql_ext.MySQLConnectorDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledMySQLDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledMySQLDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledMySQLDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.pool.PooledMySQLDatabase,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledMySQLDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledMySQLDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledMySQLDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledMySQLDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.pool.PooledMySQLDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.pool.PooledPostgresqlDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledPostgresqlDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledPostgresqlDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledPostgresqlDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledPostgresqlDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledPostgresqlExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.pool.PooledPostgresqlExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledPostgresqlExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledPostgresqlExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledPostgresqlExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledPostgresqlExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledPostgresqlExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledSqliteDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledSqliteDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledSqliteDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledSqliteDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.pool.PooledSqliteDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.pool.PooledSqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.pool.PooledSqliteExtDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.pool.PooledSqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.pool.PooledSqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.pool.PooledSqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.pool.PooledSqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.pool.PooledSqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.postgres_ext.PostgresqlExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.postgres_ext.PostgresqlExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.postgres_ext.PostgresqlExtDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.postgres_ext.PostgresqlExtDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.postgres_ext.PostgresqlExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.postgres_ext.PostgresqlExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.postgres_ext.PostgresqlExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.psycopg3_ext.Psycopg3Database
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.psycopg3_ext.Psycopg3Database = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.psycopg3_ext.Psycopg3Database, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.psycopg3_ext.Psycopg3Database, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.psycopg3_ext.Psycopg3Database
                          ...
                      - pattern-inside: |
                          $DB: playhouse.psycopg3_ext.Psycopg3Database = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.psycopg3_ext.Psycopg3Database):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.psycopg3_ext.Psycopg3Database, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.psycopg3_ext.Psycopg3Database:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlcipher_ext.SqlCipherDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlcipher_ext.SqlCipherDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlcipher_ext.SqlCipherDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase
                            ...
                      - pattern-inside: >
                          class $CLS:
                            ...
                            $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase
                          ...
                      - pattern-inside: >
                          $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase =
                          ...

                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.CSqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(...,
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.CSqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlite_ext.CSqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlite_ext.CSqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlite_ext.CSqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.SqliteExtDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqlite_ext.SqliteExtDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.sqlite_ext.SqliteExtDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqlite_ext.SqliteExtDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.SqliteExtDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqlite_ext.SqliteExtDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqlite_ext.SqliteExtDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqlite_ext.SqliteExtDatabase, ...)):
                            ...
                      - pattern-inside: >
                          if type($DB) ==
                          playhouse.sqlite_ext.SqliteExtDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqliteq.SqliteQueueDatabase
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.sqliteq.SqliteQueueDatabase = ...
                            ...
                      - pattern-inside: >
                          class $DB(..., playhouse.sqliteq.SqliteQueueDatabase,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB:
                          playhouse.sqliteq.SqliteQueueDatabase, ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.sqliteq.SqliteQueueDatabase
                          ...
                      - pattern-inside: |
                          $DB: playhouse.sqliteq.SqliteQueueDatabase = ...
                          ...
                      - pattern-inside: >
                          if isinstance($DB,
                          playhouse.sqliteq.SqliteQueueDatabase):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.sqliteq.SqliteQueueDatabase, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.sqliteq.SqliteQueueDatabase:
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.flask_utils.FlaskDB
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $DB: playhouse.flask_utils.FlaskDB = ...
                            ...
                      - pattern-inside: |
                          class $DB(..., playhouse.flask_utils.FlaskDB, ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $DB: playhouse.flask_utils.FlaskDB,
                          ...):
                            ...
                      - pattern-inside: |
                          $DB: playhouse.flask_utils.FlaskDB
                          ...
                      - pattern-inside: |
                          $DB: playhouse.flask_utils.FlaskDB = ...
                          ...
                      - pattern-inside: |
                          if isinstance($DB, playhouse.flask_utils.FlaskDB):
                            ...
                      - pattern-inside: >
                          if isinstance($DB, (...,
                          playhouse.flask_utils.FlaskDB, ...)):
                            ...
                      - pattern-inside: |
                          if type($DB) == playhouse.flask_utils.FlaskDB:
                            ...
                      - pattern-inside: |
                          $DB = peewee.Database(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.SqliteDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.PostgresqlDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.MySQLDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = peewee.DatabaseProxy(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.apsw_ext.APSWDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.cockroachdb.CockroachDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.mysql_ext.MariaDBConnectorDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.mysql_ext.MySQLConnectorDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledMySQLDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledPostgresqlDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledPostgresqlExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledSqliteDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.pool.PooledSqliteExtDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.postgres_ext.PostgresqlExtDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.psycopg3_ext.Psycopg3Database(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlcipher_ext.SqlCipherDatabase(...)
                          ...
                      - pattern-inside: >
                          $DB =
                          playhouse.sqlcipher_ext.SqlCipherExtDatabase(...)

                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlite_ext.CSqliteExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqlite_ext.SqliteExtDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.sqliteq.SqliteQueueDatabase(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                      - pattern-inside: |
                          $DB = playhouse.connect(...)
                          ...
                  - pattern-either:
                      - pattern: $DB.cursor(...).execute($SINK, ...)
                      - pattern: $DB.cursor(...).execute(..., query=$SINK, ...)
                      - pattern: $DB.cursor(...).executemany($SINK, ...)
                      - pattern: $DB.cursor(...).executemany(..., query=$SINK, ...)
                      - pattern: $DB.cursor(...).executescript($SINK, ...)
                      - pattern: $DB.cursor(...).executescript(..., query=$SINK, ...)
                      - pattern: $DB.cursor(...).execute_insert($SINK, ...)
                      - pattern: $DB.cursor(...).execute_insert(..., query=$SINK, ...)
                      - pattern: $DB.cursor(...).execute_fetchall($SINK, ...)
                      - pattern: $DB.cursor(...).execute_fetchall(..., query=$SINK, ...)
                      - pattern: $CURSOR.execute($SINK, ...)
                      - pattern: $CURSOR.execute(..., query=$SINK, ...)
                      - pattern: $CURSOR.executemany($SINK, ...)
                      - pattern: $CURSOR.executemany(..., query=$SINK, ...)
                      - pattern: $CURSOR.executescript($SINK, ...)
                      - pattern: $CURSOR.executescript(..., query=$SINK, ...)
                      - pattern: $CURSOR.execute_insert($SINK, ...)
                      - pattern: $CURSOR.execute_insert(..., query=$SINK, ...)
                      - pattern: $CURSOR.execute_fetchall($SINK, ...)
                      - pattern: $CURSOR.execute_fetchall(..., query=$SINK, ...)
                  - focus-metavariable: $SINK
              - patterns:
                  - pattern-either:
                      - pattern: |
                          class $CLS:
                            ...
                            $TY: peewee.Model
                            ...
                      - pattern: |
                          class $CLS:
                            ...
                            $TY: peewee.Model = ...
                            ...
                      - pattern: |
                          class $TY(..., peewee.Model, ...):
                            ...
                          ...
                      - pattern: |
                          def $FUN(..., $TY: peewee.Model, ...):
                            ...
                      - pattern: |
                          $TY: peewee.Model
                          ...
                      - pattern: |
                          $TY: peewee.Model = ...
                          ...
                      - pattern: |
                          if isinstance($TY, peewee.Model):
                            ...
                      - pattern: |
                          if isinstance($TY, (..., peewee.Model, ...)):
                            ...
                      - pattern: |
                          if type($TY) == peewee.Model:
                            ...
                  - pattern-either:
                      - pattern: $TY.raw($SINK, ...)
                      - pattern: $TY.raw(..., sql=$SINK, ...)
              - patterns:
                  - pattern-either:
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $FLASK_DB: playhouse.flask_utils.FlaskDB
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $FLASK_DB: playhouse.flask_utils.FlaskDB = ...
                            ...
                      - pattern-inside: >
                          class $FLASK_DB(..., playhouse.flask_utils.FlaskDB,
                          ...):
                            ...
                          ...
                      - pattern-inside: >
                          def $FUN(..., $FLASK_DB:
                          playhouse.flask_utils.FlaskDB, ...):
                            ...
                      - pattern-inside: |
                          $FLASK_DB: playhouse.flask_utils.FlaskDB
                          ...
                      - pattern-inside: |
                          $FLASK_DB: playhouse.flask_utils.FlaskDB = ...
                          ...
                      - pattern-inside: >
                          if isinstance($FLASK_DB,
                          playhouse.flask_utils.FlaskDB):
                            ...
                      - pattern-inside: >
                          if isinstance($FLASK_DB, (...,
                          playhouse.flask_utils.FlaskDB, ...)):
                            ...
                      - pattern-inside: |
                          if type($FLASK_DB) == playhouse.flask_utils.FlaskDB:
                            ...
                      - pattern-inside: |
                          $FLASK_DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                      - pattern-inside: |
                          $FLASK_DB = playhouse.flask_utils.FlaskDB(...)
                          ...
                  - pattern-either:
                      - pattern: |
                          class $TY($FLASK_DB.Model):
                              ...
                          ...
                  - pattern-either:
                      - pattern: $TY.raw($SINK, ...)
                      - pattern: $TY.raw(..., sql=$SINK, ...)
                  - focus-metavariable: $SINK
              - patterns:
                  - pattern-either:
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $INST: playhouse.dataset.DataSet
                            ...
                      - pattern-inside: |
                          class $CLS:
                            ...
                            $INST: playhouse.dataset.DataSet = ...
                            ...
                      - pattern-inside: |
                          class $INST(..., playhouse.dataset.DataSet, ...):
                            ...
                          ...
                      - pattern-inside: |
                          def $FUN(..., $INST: playhouse.dataset.DataSet, ...):
                            ...
                      - pattern-inside: |
                          $INST: playhouse.dataset.DataSet
                          ...
                      - pattern-inside: |
                          $INST: playhouse.dataset.DataSet = ...
                          ...
                      - pattern-inside: |
                          if isinstance($INST, playhouse.dataset.DataSet):
                            ...
                      - pattern-inside: >
                          if isinstance($INST, (..., playhouse.dataset.DataSet,
                          ...)):
                            ...
                      - pattern-inside: |
                          if type($INST) == playhouse.dataset.DataSet:
                            ...
                      - pattern-inside: |
                          $INST = playhouse.dataset.DataSet(...)
                          ...
                      - pattern-inside: |
                          $INST = playhouse.dataset.DataSet(...)
                          ...
                  - pattern-either:
                      - pattern: $INST.query($SINK, ...)
                      - pattern: $INST.query(..., sql=$SINK, ...)
                  - focus-metavariable: $SINK
              - patterns:
                  - pattern-either:
                      - pattern: peewee.RawQuery($SINK, ...)
                      - pattern: peewee.RawQuery(..., sql=$SINK, ...)
                      - pattern: peewee.SQL($SINK, ...)
                      - pattern: peewee.SQL(..., sql=$SINK, ...)
                      - pattern: peewee.Check($SINK, ...)
                      - pattern: peewee.Check(..., constraint=$SINK, ...)
                  - focus-metavariable: $SINK
    pattern-sanitizers:
      - patterns:
          - pattern-either:
              - pattern: int(...)
              - pattern: bool(...)
              - pattern: float(...)
              - pattern: complex(...)
              - pattern: oct(...)
              - pattern: hex(...)
              - pattern: bin(...)
              - pattern: round(...)
              - pattern: id(...)
              - pattern: hash(...)
              - pattern: len(...)
              - pattern: type(...)
      - patterns:
          - pattern-either:
              - pattern-inside: |
                  $DICT[$KEY]
                  ...
              - pattern-inside: |
                  $DICT = { $KEY: $VALUE for ... in ...}
                  ...
              - pattern-inside: |
                  $DICT.get($KEY, $DEFAULT)
                  ...
              - pattern-inside: |
                  $DICT = { }
                  ...
              - pattern-inside: |
                  $DICT = { $KEY: $VALUE, ... }
                  ...
              - pattern-inside: |
                  $DICT = dict(...)
                  ...
          - pattern-either:
              - pattern: $DICT.clear()
              - pattern: $DICT.len()
      - patterns:
          - pattern-either:
              - pattern-inside: |
                  $LIST = [ ... ]
                  ...
              - pattern-inside: |
                  $LIST = list(...)
                  ...
          - pattern-either:
              - pattern: $LIST.clear()
              - pattern: $LIST.count(...)
              - pattern: $LIST.index(...)
      - patterns:
          - pattern-either:
              - pattern-inside: |
                  $SET = { $ITEM, ... }
                  ...
              - pattern-inside: |
                  $SET = set(...)
                  ...
          - pattern-either:
              - pattern: $SET.len()
              - pattern: $SET.clear()
      - patterns:
          - pattern-either:
              - pattern-inside: |
                  $SET = { $ITEM, ... }
                  ...
              - pattern-inside: |
                  $SET = { $ITEM for ... in ...}
                  ...
              - pattern-inside: |
                  $SET = set(...)
                  ...
              - pattern-inside: |
                  $SET = frozenset(...)
                  ...
              - pattern-inside: |
                  $OTHERSET = { $ITEM, ... }
                  ...
              - pattern-inside: |
                  $OTHERSET = set(...)
                  ...
          - pattern-either:
              - pattern: $SET.isdisjoint($OTHERSET)
              - pattern: $SET.difference($OTHERSET)
              - pattern: $SET.issubset($OTHERSET)
              - pattern: $SET < $OTHERSET
              - pattern: $SET <= $OTHERSET
              - pattern: $SET.issuperset($OTHERSET)
              - pattern: $SET > $OTHERSET
              - pattern: $SET >= $OTHERSET
      - patterns:
          - pattern-either:
              - pattern-inside: |
                  $TUPLE = ( $ITEM, ... )
                  ...
              - pattern-inside: |
                  $TUPLE = $ITEM, ...
                  ...
              - pattern-inside: |
                  $TUPLE = tuple(...)
                  ...
          - pattern-either:
              - pattern: $TUPLE.len()
      - pattern: django.shortcuts.get_object_or_404(...)
      - pattern: django.shortcuts.get_list_or_404(...)
      - pattern-either:
          - patterns:
              - pattern: sqlalchemy.select(...).$FUNC(...)
              - pattern-not: sqlalchemy.select(...).from_statement(...)
              - pattern-not: sqlalchemy.select(...).prefix_with(...)
              - pattern-not: sqlalchemy.select(...).suffix_with(...)
          - pattern: sqlalchemy.select(...)
          - pattern: sqlalchemy.table(...)
          - pattern: sqlalchemy.table(...).$FUNC(...)
          - pattern: sqlalchemy.bindparam(...)
          - pattern: sqlalchemy.bindparams(...)
          - pattern: $STMT.bindparam(...)
          - pattern: $STMT.bindparams(...)
          - patterns:
              - pattern: $COLUMN.$FUNC(...)
              - pattern-not: $COLUMN.$FUNC(..., autoescape=False, ...)
              - metavariable-regex:
                  metavariable: $FUNC
                  regex: ^(contains|endswith|like|startswith|icontains|iendswith|ilike|istartswith|not_ilike|not_like|notilike|notlike|regexp_match|regexp_replace)$
